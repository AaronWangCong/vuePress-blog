<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node | AWC技术博文</title>
    <meta name="description" content="AWC技术博文是汪聪个人门户网站的一个独立子站，包括html、CSS、vue、nuxt、javascript、小程序、pm2等技术知识，致力于开源一份简洁标准的前端技术博文网站。">
    <link rel="icon" href="/photo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.f6d4bc1c.css" as="style"><link rel="preload" href="/assets/js/app.9f1f3983.js" as="script"><link rel="preload" href="/assets/js/2.b677e27a.js" as="script"><link rel="preload" href="/assets/js/4.aa1a94bd.js" as="script"><link rel="prefetch" href="/assets/js/10.5ae7e8e9.js"><link rel="prefetch" href="/assets/js/11.dd24e437.js"><link rel="prefetch" href="/assets/js/12.75f66943.js"><link rel="prefetch" href="/assets/js/13.dc5f4310.js"><link rel="prefetch" href="/assets/js/14.abc93e99.js"><link rel="prefetch" href="/assets/js/15.70374c60.js"><link rel="prefetch" href="/assets/js/16.1ab718b6.js"><link rel="prefetch" href="/assets/js/17.f1fc0276.js"><link rel="prefetch" href="/assets/js/18.f1b68da9.js"><link rel="prefetch" href="/assets/js/19.12131d4d.js"><link rel="prefetch" href="/assets/js/3.c1ac75a0.js"><link rel="prefetch" href="/assets/js/5.d3a086a4.js"><link rel="prefetch" href="/assets/js/6.85ac9f22.js"><link rel="prefetch" href="/assets/js/7.979b5179.js"><link rel="prefetch" href="/assets/js/8.b0f1be58.js"><link rel="prefetch" href="/assets/js/9.7238662b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f6d4bc1c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">AWC技术博文</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">博客</a></div><div class="nav-item"><a href="http://home.wangcong.wang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人门户
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/AaronWangCong/vuePress-blog.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">博客</a></div><div class="nav-item"><a href="http://home.wangcong.wang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人门户
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/AaronWangCong/vuePress-blog.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blog/" class="sidebar-link">一、前言及目录</a></li><li><a href="/blog/JavaScript.html" class="sidebar-link">二、JavaScript</a></li><li><a href="/blog/Jquery.html" class="sidebar-link">三、JQuery</a></li><li><a href="/blog/H5C3.html" class="sidebar-link">四、HTML、CSS</a></li><li><a href="/blog/animation.html" class="sidebar-link">五、动画</a></li><li><a href="/blog/wxApplet.html" class="sidebar-link">六、小程序</a></li><li><a href="/blog/Vue.html" class="sidebar-link">七、Vue.js</a></li><li><a href="/blog/Nuxt.html" class="sidebar-link">八、Nuxt.js</a></li><li><a href="/blog/Node.html" class="active sidebar-link">九、Node.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Node.html#搭建一个node服务" class="sidebar-link">搭建一个node服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Node.html#_1、安装node环境" class="sidebar-link">1、安装node环境</a></li><li class="sidebar-sub-header"><a href="/blog/Node.html#_2、创建一个简易的node服务" class="sidebar-link">2、创建一个简易的node服务</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/Node.html#结合koa框架实现接口" class="sidebar-link">结合Koa框架实现接口</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Node.html#_1、目录结构如下" class="sidebar-link">1、目录结构如下</a></li><li class="sidebar-sub-header"><a href="/blog/Node.html#_2、安装koa依赖" class="sidebar-link">2、安装koa依赖</a></li><li class="sidebar-sub-header"><a href="/blog/Node.html#_3、app-js" class="sidebar-link">3、app.js</a></li><li class="sidebar-sub-header"><a href="/blog/Node.html#_4、koa-route" class="sidebar-link">4、koa-route</a></li><li class="sidebar-sub-header"><a href="/blog/Node.html#_5、启动测试" class="sidebar-link">5、启动测试</a></li></ul></li></ul></li><li><a href="/blog/SEO.html" class="sidebar-link">十、SEO搜索引擎</a></li><li><a href="/blog/optimization.html" class="sidebar-link">十一、网站优化</a></li><li><a href="/blog/markDown.html" class="sidebar-link">十二、MarkDown</a></li><li><a href="/blog/Linux.html" class="sidebar-link">十三、Linux</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node"><a href="#node" aria-hidden="true" class="header-anchor">#</a> Node</h1> <div class="tip custom-block"><p>对于一个前端工程师来说不仅仅要会前端的内容，后端的技术也需要熟练掌握。今天我就要通过一个案例来描述一下前端是如何和后端进行数据交互的。</p></div> <h2 id="搭建一个node服务"><a href="#搭建一个node服务" aria-hidden="true" class="header-anchor">#</a> 搭建一个node服务</h2> <h3 id="_1、安装node环境"><a href="#_1、安装node环境" aria-hidden="true" class="header-anchor">#</a> 1、安装node环境</h3> <ul><li>安装node</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>  <span class="token function">npm</span> i -g node
</code></pre></div><h3 id="_2、创建一个简易的node服务"><a href="#_2、创建一个简易的node服务" aria-hidden="true" class="header-anchor">#</a> 2、创建一个简易的node服务</h3> <ul><li>新建一个项目文件 <em><code>blogDemo</code></em></li> <li>进入项目文件根目录新建 <code>index.html</code></li></ul> <div class="language-html extra-class"><pre class="language-html"><code>  <span class="token doctype">&lt;!DOCTYPE html&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    这里是首页
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>继续在根目录新建 <code>server.js</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//引入文件读取模块</span>

  <span class="token keyword">var</span> documentRoot <span class="token operator">=</span> <span class="token string">'D:/node.js/blogDemo'</span><span class="token punctuation">;</span>
  <span class="token comment">//需要访问的文件的存放目录</span>

  <span class="token keyword">var</span> server<span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

      <span class="token keyword">var</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>url<span class="token punctuation">;</span> 
      <span class="token comment">//客户端输入的url，例如如果输入localhost:8888/index.html</span>
      <span class="token comment">//那么这里的url == /index.html </span>

      <span class="token keyword">var</span> file <span class="token operator">=</span> documentRoot <span class="token operator">+</span> url<span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

      fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span> file <span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">/*
          err为文件路径
          data为回调函数
              回调函数的一参为读取错误返回的信息，返回空就没有错误
              data为读取成功返回的文本内容
      */</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
              res<span class="token punctuation">.</span><span class="token function">writeHeader</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
                  <span class="token string">'content-type'</span> <span class="token punctuation">:</span> <span class="token string">'text/html;charset=&quot;utf-8&quot;'</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;404错误&lt;/h1&gt;&lt;p&gt;你要找的页面不存在&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
              res<span class="token punctuation">.</span><span class="token function">writeHeader</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
                  <span class="token string">'content-type'</span> <span class="token punctuation">:</span> <span class="token string">'text/html;charset=&quot;utf-8&quot;'</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将index.html显示在客户端</span>
              res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token punctuation">}</span>

      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'服务器开启成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>在根目录打开 <code>命令窗口</code>，启动服务。</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>  node server
  // 或
  node server.js

  // 会显示启动成功
  d:\node.js\blogDemo<span class="token operator">&gt;</span>node server
  服务器开启成功
</code></pre></div><ul><li>访问 <code>http://127.0.0.1:8888/index.html</code> <img src="/assets/img/node01.8bc87071.png" alt="name" title="描述"></li> <li>至此简单的node服务搭建成功.</li></ul> <h2 id="结合koa框架实现接口"><a href="#结合koa框架实现接口" aria-hidden="true" class="header-anchor">#</a> 结合Koa框架实现接口</h2> <p><em>我们需要用到上面的方法搭建工程的目录，并且在目录中通过npm来安装 <code>Koa</code> 框架以及一些用到的依赖库。</em></p> <h3 id="_1、目录结构如下"><a href="#_1、目录结构如下" aria-hidden="true" class="header-anchor">#</a> 1、目录结构如下</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZYAAADmCAYAAAD2raPjAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACIqSURBVHhe7d1Rd1PXlQfw+SR9M23TJnKoIR2aGdUkJGNWlh1iMhPPKoYEFnHIqkyjdHBnYhKclDhljBstiCEZ2Y0GEAkyy3IgqoNwKztID+hlnuah7dO85FvsOfvqHunoemvryrKMwf+H37J0zrlXSu9a+99zzhX3737yk5/Qes3OztL8/Lz3d8+ePeKYoJMnT3rHsKGhIXFMM9Hoc/CgvfAOXV8t0fxH/XI/wCPie9/7HrRo3cHS19dXDQgOC2mMZO/evdXj3n33XXFMM9LFh80ySnPLZSqXy7Q8P0WHxDEAjw6pcIJu3cEyMjJSDQgOGWlMIzMzM95xn3zyidjfjHTxAQA6QSqcoFt3sNglrWvXron9mlOnTlVDSepvRrr4AACdIBVO0LUdLOsJB14C4+N4b0bqb0a6+AAAnSAVTtCtO1iOHDlSDZZWN+F5lsPHffjhh2J/Mz/96U8BADaFVDhBt+5gcTfheWlLGiNZ76a/S7r4AACdIBVO0K07WNj09LQXEFevXg29gW+PYRxO0phmpIsPANAJUuEEXVvBcuDAgWpI8B1ezYLC7q2w9c5WmHTxAeDh8fjj3RSJ7KTdu58S+7cSqXCCbt3Bwj+I5DCxQcF45vL666+v+bEk78GcP3++Oo5vN3b7WyVdfICH2Uf/81uP1NcJm/15QRwso6O/oieeeJJ27dotjtko9+7da0o6zpIKJ+jWFSxSqEg4aIJtvGEf9lf6jUgXH+Bhtl2ChUNk584eL1i4oP/nf055rzsdLhoEy8ZrOVikUOG7vPguMXf/JMiOkc7ZKuniAzyMbIEP4j73/1Gz3//+92uOb5X0WUwau5F4yYtnJ4OD/0xjY//usf9d169/QU89tYd6enaJx66X+79dI3Zc8FiXVDhB11KwNAoVd+Oe91k4QHgPhfFr3otxz9Mu6eJreClOaq85Rwvlyj9TwlZuXabR3krfuYUVSp0Iju+lQ2fTtLRijynR8sI0HfeP8ew7QdMLy1SqnrdES5ePe33nFmxbpX3lVorGD/X6x9Z/l3J5gc6Z9hOpFSovJ+lVe36r9yzdKJVp4ZxtC/HdYMuQijwLjrOFsN1wkT6L2X4+v/0sl3uOVvFshINjdnZOPPedO3lTQ17w9lyk4zuFP9v924hUOEEXOljChMpmkS5+Ixwqf/3rX8W+GlPMV1J0gl/ve5UuL9UKtRQsA+cWqFS6RRdGB6jXvO8dGKULt0pUWjhHAzymd5RSy2VaTo/Tq/vqj2XuOXsHjtN4asmczwTIALc538VxInWLVlZWKP12ffsrF/jYUvX7Nv1usCUFC3yQW4g3cubitu3fv987/y9/+cu69maFtxmeqfCshM+zuPgVHT8+4s1c+L2drTz55E+8JbGNmLXweZux49y/jUiFE3ShgmUrhQqTLr7Ehsp3330n9tfUinnvwNsmFJYp6Rf+tcFyyARPiW6ctTMMX+8YpUtLdPmQKe7Tt9RCvvacvXT2Bs9oDpnXjYJlidKX02b24Z73bUqv3KJ0esUPlubfra4dtoxWgqVZIQzD/bzguSXB48Pi/RQOEj7H3NwfvBCxeyznzk1Vl8A4fOxmvnSeVgS/u8SOc/82IhVO0DUNlq0WKky6+EFuqIQKFmf5iWcahxouhfHYyvJUra2Cl7i4wNu/wX5LmgX1mjBaSZ0wr+u/S9kPGV4KWzj3KiU59F71jzl7w3zXMRr1+rit+XcLtsPDp1khbJUtthrpuDB4ecvOVn7+82eqm/QcLPaOMMZ9PIaXxNrdyNe+s9sX/NuIVDhB1zRY3N+ebIVQYdLFdwVDpZUZCy+FjZsZwEr6ba+v/WBxgsLMNirj1gbLwIWlWrCIM5ZKePBsqPLdXqELS0teyNg+BMvDr1mRY2HGNMPnaIV0jjDs3V8cLu5shF/b37DwjOUXvzjsjePZTbvLYdp3dvuCfxuRCifoWgqWrRAqTLr4lhQqLQULO5GilVvTtN+8XhsCleWm9Fjj5aZDl5eoZGYSvMdR7T+3oAQLh4RdwtKDxdusX7lBZ8fS3nfkZbFasDT/bnXtsOU0K3IszJhm+BytkM4Rhg0WXgZrtDnPQWKXy3g5bCOD5dfLVBXsC/5tRCqcoAu1FMbhwr8/2QqhwqSL3x6nmPceajJjUTbIb4xXwmTAnK9UolsXRmnQ27zfR4MXbonBsm9wlKbNe77jqxImTYLFe73sbeTbvRS3r+l3gy2tWZFjYcY0w+dohXSOMDhY+K4vPgfvp0i/tO/u3kkTEx94Y3hTf7OXwpqRCifoQm3ebzXSxW+PKebOvkb97ca1dlYp4L10fHqBlku2fYVupWr7Mqz30FlKL5nA8I8rLS/Q9Il9wjlXaOmGeztw/Xfhfg4hNzx+OjBNt5Zqtx7X9YX4brB1hSl2YQuixhbYsKRzhMF3e/EmPZ+Dw8NdAuO/3M/7KtzPAcThEzxHq7Tv7PY1GhMkFU7QIVgAtpAwxS5sQdTYAhuWdI4wODw4LOwG/pkz73sb9TyTYbwE9s03d7w+fs13jEnnaYX7vRuRjmtEKpygQ7AAbCFhil6rhVHiFtkwpHOExXsmHCY2XCS/+c1/bNgPJKXzB0nHNSIVTtAhWAC2EKkISqRjtzIOF56h8OY8b+TzfwP/WJKXyTh0eElM2n/ZCqTCCToECwBsCg4OXurizXrea+EZCr9vd7O+06TCCToECwCAQiqcoEOwAAAopMIJOgQLAIBCKpygeyiDpatrBwDAppAKJ+gQLAAACqlwgg7BAgCgkAon6BAsAAAKqXCCDsECAKCQCifoECwAAAqpcIIOwbLVDSepUM7QhNQHAB0nFU7QIVh8s7NzYvsDh2ABeKCkwgk6BIuPnzI5N7cFwwXBAvBASYUTdAgWHwfL6uq3LYbL+5QpFyg1k6a891CtAmUmBmhoKmPCwH8/ebA2PjJA4+k8Fe1DvPIZmhzqrvZHhiYpky/6D+gqUHLEtLvBEjlGyXyZ8qlY7ZwA0FFS4QQdgsXHwfLkkztbDBcOljIVM5PUH+mm/slFKhaLVPDe76C+iYx5n6a4N7abYqkCFXOXaCRqwiQSpaOJHBULKRrh/qg5lzk2O3WYesz7npFLlIib9mqw7KeJTNF81vvUV/18AOg0qXCCDsHiqwXLagv7LZUZS/Ko9j5PM0P8Ok7poukbtn3MzEAKRUrFdlB0Kkfl7CRFq30+L1gWKZnMmxlOko6awKrrB4COkgon6BAsvspSWCuhwvwgqYaF9p5fr90rmciUKTOxg4aTBSokD9f1ebxg4aWxIqXjtWUzANgcUuEEHYLFx8HS+p1hrQQLz1jM7GXQ9rHajGVoJk/F9GmKVPt8/lLYlLesZoKpL9APAB0lFU7QIVh867vduJVg6aZ4urh2jyV/iYZ57GCCcmZseuJggz2WbjrKy2EIF4BNJRVO0CFY2tJKsBiRIZrMmHDw7worZJMUc0KiL5akbMG/Y6ywSAk+rhosPKaygc97LfYYAOgsqXCCDsECAKCQCifoECwAAAqpcIKurWDZu3cvvf766/Thhx/SJ598QvPz8x5+zW3cx2OkY9shXXwAgE6QCifo1hUsHBbvvvtuNUia4bEbGTDSxQcA6ASpcIKu5WAZGhqiq1ev1oXGyMgIHThwgPbs2eON6evroyNHjnizFjuOj+Fjg+dbD+niAwB0glQ4QddSsHBY2KCYnp72wkQa5+KZihswfA5pXCukiw8A0AlS4QRd6GDh2YYNB5592NkJs+2zs7N1x7h4VmPHtTtzkS4+AEAnSIUTdKGChWcddvmLw4P/8ga9FC7uccH3Nlz4XO3suUgXHwCgE6TCCbpQwWI36nlJi8NkZmbGe++GC78PBknwPbPLYnzOYF9Y0sUHAOgEqXCCrmmw8MzChoadZUjhcu3atWqQ8D7K+fPnvffurKbR+VolXXwAgE6QCifomgaLXb4KzjCC4cIb+RwuJ0+erAZHkD3Wzlr43O45w5IuPgBAJ0iFE3RNg8WGgHQ3V6NwsUHC+O6x4HH27jI+d7AvDOniAwB0glQ4Qdc0WGxwNFq2ahYu0h1g/DsXOz7YF4Z08R89/E/qlykzLvUBwGaRCifomgaLDQh+HZyNMA4HDp1Gy2LB81n2eKmvGenib7T9+/eL7QCwvUiFE3QtBUswCNxbjxuFiz2eub9zsW3u+cKSLv5G4lD5y1/+IvYBwPYiFU7QhV4K4+Urt939FT4LGy58LI/j1zzWPWdY0sXfKDZU+ImSUn+9/RRLLvqPDjbSp/32XTQyU2vPZyZpyH9WPT+KuJC6RGl+7kphgRYK/Mhh55yxFBULSRpe82yX+s8qZiepn9sjAzSets94KVA2GaM+ey4AaJtUOEG37s37U6dO1QUGk8LFvd2Y2/jvVt28d0MlVLDE0yYEUjTSU98enVykcj5F8f5u6uo5TIlckXKJg14fBws/BXKS+8z7kVSBiul49dhYqkj5GR5bHyzDMyY87Dk5TBImrOzx2SkaNt8h0h+nlBdUeDY+wEaRCifomgaLvd04GAKNbiu2/9xLo3Bh9geXW+l242CohAqWkRQVijlKDO9y2ge8IEmPO8V9IkPl3BRFzWsOlmIqVuvjJ0QWUxTz3scoxefr59dusHB7gVIj/jFVa5+jP5w0QeOeHwDaIhVO0DUNFrtsxfi1beewsHssln1v+6VwaXS+VkgXvx1SqIQKlq5uGprMUJ6XofJmFjLEYXLYu5ursjTl8Ja3/KWw5GHnHAdpJl+kVMy85hmQH0D1wcKv7eOJXdwufFbm/cA4AFgvqXCCrmmwMPefdHHbOSx41sGzF3tbsQ0W2x8MF7u09mj9ky67aDiRqyyLdQ3VgkIYuzZYdtDgTN6bZcTTRcpORv32YLDUz0xqY3I0FQ22A8BGkQon6EIFC88s7CZ8s+UrN1iYGy72H7Lkc613tsKki/+g9XjLYmmKm9eDJmTK+SSNRNfudUjB0jV4ifKFHOUKZlbib/LXB0u3FzrF3KXKOat7LH57ZpIGA/s8ALAxpMIJulDBwtx/Np8fOSyNYcFgYRwu7t1hj8w/mz+epqJdfiosUjJmf/uy37lTy+D9Ef/OLzFYvH2ZMhXTpylSbXODxYgM0WSmds58Kl5ZMosco0S24HzWIk15ezQAsBGkwgm60MHC3FuMeUkrOOvgdg4Qt41vObb/ICUL3l22HtLFBwDoBKlwgq6lYGE823BnHxwwHBb2dy48O3nxxRe9WY3dm2F8TLszFUu6+AAAnSAVTtC1HCyMZypuaDTDY9vZUwmSLj4AQCdIhRN06woWi8OCN/N51mI36Bm/5jbu28hAsaSLDwDQCVLhBF1bwfKgSBcfAKATpMIJOgQLAIBCKpygeyiDJRp9DgBgU0iFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYHlkjNGV1TJlP5L6WvTix3S7/CeaOy70AWwzUuEEHYKlJfvo06VeKi49Syf4/aF9NHd7LxWLps24m3mWXltzDAA8zKTCCToES0v20X+v9NL9lWdo1A+Z+/dNoNx+hhYW9tLS9X3CMQDwMJMKJ+gQLC1xg+VZyphZyv3iM/TeC9JYyVF650qOVu2zU+an/PaXaGyu1r6cvUhvPl855ny2TKvXUzS/avpWb9Ot1RLNn3HO+c6XVFq9Zr7Px5Qtr9KVUdtX/1ml2xcrs6nnX6eP5v/kP79llW5feY8O2XNZo9fMcYt03nvf6DsDbA9S4QQdgqUlbrA8R+9lKjMWtpR5lkabBcyZmyYEvqSxwLiX+YmTy1/Smdf6KfrC2/TZNyX65rM3vT4OlnJpkRLcZ96PXV+l0vwH1WPfuV6i5TkeWx8so3MmPOw5OUw+M2Flj7992fuuz7/2AV33gqpy7io3WBp8Z4DtQiqcoEOwtKQ+WLhtdOoZun3XD5i7tXbR2Je0WrpDn42+5LS/7gXJ/EdOcT+/SOVvLtPL5jUHS+n6e7U+LvqlL+kd7/17dJ3P9xq/doOF21fp+ph/TNUHNF+q35QfvWKCxj0/c4NF/M4A24dUOEGHYGnJPrrOy18mQLzNe0fiNofLXpo7Ud9er5/eTCzSMi8pLZtZyJscJm97d3NVlqYc3vKWvxR25W3nHG/S3HKJrr9jXvNswg+g+mDh13Ypy8XtwmdlP64fV7cUJn1nZyzAI04qnKBDsISyjz5deIYW/M36FW+Tfh/N3d1Lt7l9YS+t8IyF91vE44NeotHP7lSWmKKjtaAQxq4Nlufo+NyfvFnGmfkS3U78q98eDBbpdmFuv0MzLwfbA+qCxXK/s9sO8GiTCifoECxhHHqWbttbiheepRPexroJG/dW49vP0nveklQ4L3hLTDfpjHl93BTs8vI1Gnt57WxACpbo8RQtr96hb1ZN8fc3+euDpd8LndI3qco5q3ssfnv2Ih0P7pm8lqRvyjlKcOiIwVL/nd12gEeZVDhBh2DZTB/dpJJdflrN0ZV3jvp9R507tQzeH/Hv/BKDxduXKVNpfoqer7a5wWI8P0qJbO2cy9c/qCyZPT9Gn91edT4rRzMciI2CpeF3BtgepMIJOgQLrMXBsnqN4lIfwDYjFU7QIVgg4CX/lmZ3NgSwfUmFE3QIFqh6k3/7wkteyzfpo0PyGIDtRiqcoEOwAAAopMIJOgQLAIBCKpygQ7AAACikwgm6hzJYHnv8CQCATSEVTtAhWAAAFFLhBB2CBQBAIRVO0IUKlvn5+aZOnjwZeqwV/JywpIsPANAJUuEEHYIFAEAhFU7QIVgAABRS4QRdR4NlZGSEDhw4UMftD35OWNLFf3S8QbMrZZo/I/UBwGaTCifo1hUs165do+np6TpHjhzxxrptfX196rmCfWFJF79df/g8Jbavy8Hf02LpJv1W6gtqZSwAbDqpcIJuXcHCoSGNC8M9j9QfhnTx2/Xdd9/RH1IbFC5H56hQDhkWrYwFgE0nFU7QtRUsp06dovPnz6t4TKNzue2tkC5+uzhYvr13r8VweZFOzn1lgsF/XskXZ+ixszdrzzoxCnPHzLjn6OTFryhv2+9+Qe8NmOPFsWdpvrxCs0f9zxiI0+xXK/6YEi2ee9n/bADYDFLhBF1bwcJ/g31BwdmN2+e2t0K6+O3iYNn993taC5dTX1Bx5Qq9+bNA+5pZyDG68MUc/XroaXps98v0u69KVPxirMFYN1iO0eW7ZcpfGaOXdj9BPQfP0IVzh/1xALAZpMIJuk0LFmms+xmtkC5+u6rB8u234fdbfnmFCqU/0oWjJjDc9mbLWzxTuXm28loLlreuVIKr2gcAm00qnKBDsPi8pbBWQsXzFP3i3M3KEtfdm/S74acq7WvCgsddocW7ZqZS8pe+wgSLG0AA8EBIhRN0CBaft3m/7jvDnqZXL/6xNrsIhoW3ZPYF/XbkZXpp4DnqCTtj4XF3P6V/qfYBwGaTCifoNn2PZSNIF79d7d5u/PfestgX9Gt+f/Ai5cp/pGneoDfvXzKhU/7jxco+yb43aPqrUi1YAmPrgmX3GF0vlSj3aYyewR4LwAMhFU7QbVqw8O9cRkdH67if0Qrp4j8QZ8xMxL+jq7zyFc2+9aLf9yL99qYJD9Oe/9QEwb44zd61427S7y66S1yBsXWb9yZMhs/RvD22fJf++9Rz/nEAsBmkwgk6LIUBACikwgk6BAsAgEIqnKBrK1j4x4/8WmN/IMmvg+dxP6MV0sUHAOgEqXCCrq1gaQWCBQAeRlLhBN26guXq1aviP9/CeDxv1Afb+ZjgeYKfE5Z08QEAOkEqnKBbV7BoeDz/E/pSX1Dwc8KSLj4AQCdIhRN0D2WwdHXtAADYFFLhBB2CBQBAIRVO0CFYAAAUUuEEXahg2Wqkiw8A0AlS4QQdggUAQCEVTtAhWAAAFFLhBB2CpUOOJgtUzpwW+wDg4SEVTtAhWHyzs3NiOwBsb1LhBB2CxccP+pqbQ7gAQD2pcIIOweLjYFld/balcJnMlimXGKi1RacoV87QRGQHTWTKVEge9vt20cjMIhW8Z6qUKZ+ZpCEzJjKRoXJuiqL+8f2JnHmfoH7/fSxVrD8/AGw6qXCCDsHi42B58smdLYVLdHKxLgiiUzkqpk9TxLx2g8Ubl09RvL+bunoOUyLHgXGwLoi6uqI0ZdqLxUWa9N4fpmShQMnh2ucBwOaTCifoECy+WrCsht9vibxPmXKOpqL8vhIM6XilrxYsA16QpMdNqNjjqjMVv4+P4XPlkzST8d9z6BRTFLPHAMADIRVO0CFYfJWlsBZCxdNN42kz+5iKUld/oi4IasHCMw/7aGFHIUnDZtxwslAZF09TIRWrzHrMX14mK6bjzmcBwIMgFU7QIVh8HCzruTMsMp6mopl9DCdyJhjeqLbXgmWIZvJFSsXWHuuJpczxCZpI5StjOKC89wXKTDizHAB4IKTCCToEi2/dtxtHTlO6mDNhUL8f4u6xDPKmfD5JI1EpKOLm+Dzlc2mKe+95hmPe5+0SGwA8SFLhBB2CZQPE00UTHJdo0Glzg6Wraz+Np/O1ZbBigVL+Xgwvp/HYcuZ9b9Of2/huMPemAAB4cKTCCToECwCAQiqcoEOwAAAopMIJOgQLAIBCKpygQ7AAACikwgk6BAsAgEIqnKBDsAAAKKTCCToECwCAQiqcoEOwAAAopMIJOgQLAIBCKpygQ7AAACikwgk6BAsAgEIqnKBDsAAAKKTCCToEi+/pwN9wjnnPWsmMS33NbOATIoeTVOAnUUp97erkuQEeAlLhBB2C5bEf0NIvHqMx//1nB39Mn/84MKYjNi9Y4qkC5Wfsv7TcIgQLbHNS4QTd9g4WEyr3frWT/jb8Qzrut03/czf9X/xxSnvPne+kzQuW+n/Cv0UIFtjmpMIJum0bLE9Hfkj34zvpf4d+UA0V6+KQCZd/e4K+2lnfvhY/874WDpUCPuk9x77y+GFTkPvs2P0USy6aIl15Jks+NUUpN1giA84zWwqUTcaoz7R7DwnLJfxnvXR7z34pJI9Vn93i8Yv/1HjaOX+comsei1wJCH4ccjmbpETW/OX2/CU62h+jVN4fl09SzD5kDMEC25xUOEG3TYPFzFT+bSf9zwvfp38S+3fQ2PNP0N9+82P6TOirWRss5eIiJYZ3eUExmS1Wn1sfnVw0BTtF8f5u0xelkSSHSO3YkVSBitkpGu7ZQZH+uAmdIqXj/MRJDgf/NRf5YpriwdmUV/wrYdJv+npGkpRfE3i1GYsXLOU8JUfM9+x5w3xWmYrFXOV95BglTcDkEgPOuREssH1JhRN0CBaxf/3BwrOJan88TcVCkoa7Bswsphx4hr2ZIRTtsZXHE88M2r5K8S+mYt7rSCxFhUKKUmYmlJmIVsdUecV/kSargWM/r/JeDJbsZHXWI77PvF8Zj2CBbU4qnKDDUtiGL4U5exlclL1gkfZT3DY+j78M5bLFvWs/TZmg4CWroerxDqH483dRg6V67ibvESywzUmFE3TYvP9VO5v3YYNliGbyRUqPOzOWyGkzS3GDJUdTdl8jIHKUz5OhTHV5LDAGwQLQMVLhBN32DhbW1u3GYYPFL9b5JI1ETTBEBiieylGxGiyVTfliZpIGe/xjLd7z8AMl4i2tpSjGodefoBwvf3EYNQkW79ypmLzU1ew9ggW2Oalwgg7B4lvfDyTDB0tXZIimMqZge8tcBcpMna5fHjMBUr1LixUXaarfFPmZvAmc9ynqnTNqPsO/K6yFYIkcvUR577yVMQgWgPCkwgk6BAsAgEIqnKBDsAAAKKTCCToECwCAQiqcoEOwAAAopMIJOgQLAIBCKpygQ7AAACikwgk6BAsAgEIqnKBDsAAAKKTCCToECwCAQiqcoEOwAAAopMIJOgQLAIBCKpygQ7AAACikwgk6BMsj6Kj3j0ieFvsAoDVS4QTdNg+WH9DHX/8D3fu6m17h930/opnsHrp3z7QZd679mPrXHAMA24lUOEG3zYPlh/Rff+6l+3/upuGu75uQ+Tndv/+PdCe7m27ceIq+/vxHwjEAsJ1IhRN0CJZqsPyIrt0zr+/10FvBh201tJ9iyUUq2GeopO3y0y4amam15zOTNOQ/kdJ7ZkvqEqULpq+wQAveQ7ycc8ZS/nPyd1Ck/zSl8/65C4uUjO2vjPGekWLeJ3JUNH32uSuW+1yYvliSsvxZ3ndJ07gzDgCakwon6BAs1WDZQW9d+wczYzHv7z9NX197nIabBYz/RMeRwLjo5CKV8ymK93dTV89hSuSKlEsc9Pq46JeLGZrkPvN+JFWgYjpePTaWKlJ+hse+QSkTOtmpw9TT1U398RQVimmKc0B5wWICK/mG6av/bFYLlrj3+OPUyK41YwAgHKlwgg7B4gQLtw1PdFP2TrQSMHdq7aIRLvY5Sgy7hXvAC5K659tPZKicm/KeAslFnx8TXO3jkCimKOa9j1GKz9dvXnNo5S/RoB3Xddh7RHEq5h+jPCO/FiyVcMolOJzksQCgkwon6LZ5sDxGn/PylwkQb/Pe8WGWZy4/o5lX6tvrddPQZKby2N+8mYUMcZhwANilJ4e/vOUuU1UcpJm8HxgcJn4AeWEUPIfhLXs1eVyw+xmRoUnKeMtpecpMDlWfew8A4UiFE3TbNFgeo49v7KYbX//Mm5n8+fPHTNsPaebOzyjL7Teeoj/zjIX3W8Tjg3bRMO938LJY11AtKISxa4NlBw3yc+3NLCaeLlJ2Mlppd2Y57lhPC8Fi9QwnKOcti9WPBQCdVDhBtz2Dpe8Jytpbim88Tq94G+smbNxbjbPd9BYvSUnHC3q8ZbE0xc3rQRMy5XySRqLOcphPKvpdg5coX8hRrmDCwt/k74rw/kjRzDIOrl3GEoKFQ6mQesN7LX5GT2VZrO5GAQBoSiqcoNvmS2FtGk97d2V5y1TuXVtd+2k8na8tYfFMwS/oYtH39mXKVEyfrluqihxNOHd0mf7sVOV3NaGD5bQJJ3t8gbLJGPU5xwBAc1LhBB2C5RHEwZKdXDtbAoDWSYUTdAiWR0ykf5KyxTzNDMr9ANAaqXCCDsHyyDhNGbvklTiGu78ANohUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhBh2ABAFBIhRN0CBYAAIVUOEGHYAEAUEiFE3QIFgAAhVQ4QYdgAQBQSIUTdAgWAACFVDhB8z36fw99JrLULnKXAAAAAElFTkSuQmCC" alt="name" title="描述"></p> <h3 id="_2、安装koa依赖"><a href="#_2、安装koa依赖" aria-hidden="true" class="header-anchor">#</a> 2、安装koa依赖</h3> <ul><li><code>cd</code> 到你的工程目录，然后执行 <code>npm i koa</code> 目录里就会多出 <code>node_modules</code> 这样一个文件夹，里边存放用到的一些依赖库。*
<img src="/assets/img/node03.87ac7371.png" alt="name" title="描述"></li></ul> <h3 id="_3、app-js"><a href="#_3、app-js" aria-hidden="true" class="header-anchor">#</a> 3、app.js</h3> <p><em>接下来我们创建一个 <code>app.js</code> 文件，用来设置访问服务器时用到的路由，代码如下</em></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">var</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-route'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//需要通过npm来添加此依赖</span>
  <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./service/WebAppService.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//引用WebAppService.js</span>

  <span class="token comment">/*设置路由*/</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>controller<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/ajax/search'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span><span class="token string">'no-cache'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> params <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>req<span class="token punctuation">.</span>_parsedUrl<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> key <span class="token operator">=</span> params<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
      <span class="token keyword">var</span> start <span class="token operator">=</span> params<span class="token punctuation">.</span>start<span class="token punctuation">;</span>
      <span class="token keyword">var</span> end <span class="token operator">=</span> params<span class="token punctuation">.</span>end<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">yield</span> service<span class="token punctuation">.</span><span class="token function">get_search_data</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Koa server is started'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4、koa-route"><a href="#_4、koa-route" aria-hidden="true" class="header-anchor">#</a> 4、koa-route</h3> <p>1、通过 <code>npm koa-route</code> 来安装*
<em>然后我们需要在service目录下创建一个 <code>WebAppService.js</code> 文件，用来请求接口，代码如下</em></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  exports<span class="token punctuation">.</span><span class="token function-variable function">get_search_data</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>start<span class="token punctuation">,</span>end</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

          <span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
              key<span class="token punctuation">:</span>key<span class="token punctuation">,</span>
              start<span class="token punctuation">:</span>start<span class="token punctuation">,</span>
              end<span class="token punctuation">:</span>end
          <span class="token punctuation">}</span><span class="token punctuation">;</span>

          <span class="token comment">/*请求MobAPI里的火车票查询接口*/</span>
          <span class="token keyword">var</span> content <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> http_request <span class="token operator">=</span> <span class="token punctuation">{</span>
              hostname<span class="token punctuation">:</span><span class="token string">'apicloud.mob.com'</span><span class="token punctuation">,</span>
              port<span class="token punctuation">:</span><span class="token number">80</span><span class="token punctuation">,</span>
              path<span class="token punctuation">:</span><span class="token string">'/train/tickets/queryByStationToStation?'</span> <span class="token operator">+</span> content<span class="token punctuation">,</span>
              method<span class="token punctuation">:</span> <span class="token string">'GET'</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>

          <span class="token keyword">var</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>http_request<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token keyword">var</span> body <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
              response<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              response<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                  body <span class="token operator">+=</span> chunk<span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              response<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><em>这样实际是做了一个接口的转接，我们不仅可以请求本地的接口而且还可以请求第三方接口，避免了跨域请求时浏览器阻断请求。</em></p> <h3 id="_5、启动测试"><a href="#_5、启动测试" aria-hidden="true" class="header-anchor">#</a> 5、启动测试</h3> <p><em>这样实际是做了一个接口的转接，我们不仅可以请求本地的接口而且还可以请求第三方接口，避免了跨域请求时浏览器阻断请求。</em>
接下来我们通过命令来开启服务，终端输入node app.js</p> <h1 id="既然大侠光临，不如留一手评论"><a href="#既然大侠光临，不如留一手评论" aria-hidden="true" class="header-anchor">#</a> 既然大侠光临，不如留一手评论</h1> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新: </span> <span class="time">8/2/2019, 3:09:34 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/Nuxt.html" class="prev">
          八、Nuxt.js
        </a></span> <span class="next"><a href="/blog/SEO.html">
          十、SEO搜索引擎
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9f1f3983.js" defer></script><script src="/assets/js/2.b677e27a.js" defer></script><script src="/assets/js/4.aa1a94bd.js" defer></script>
  </body>
</html>
